<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TryHackMe: Network Services 2 Walkthrough | doretox</title>
<meta name=keywords content="TryHackMe"><meta name=description content="Network Services 2 TryHackMe Room Walkthrough."><meta name=author content="doreox"><link rel=canonical href=https://doretox.github.io/posts/network-services-2-walkthrough/><meta name=google-site-verification content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://doretox.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://doretox.github.io/favicon.png><link rel=icon type=image/png sizes=32x32 href=https://doretox.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://doretox.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://doretox.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://doretox.github.io/posts/network-services-2-walkthrough/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-166484777-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="TryHackMe: Network Services 2 Walkthrough"><meta property="og:description" content="Network Services 2 TryHackMe Room Walkthrough."><meta property="og:type" content="article"><meta property="og:url" content="https://doretox.github.io/posts/network-services-2-walkthrough/"><meta property="og:image" content="https://doretox.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-26T00:00:00-05:00"><meta property="article:modified_time" content="2023-07-26T00:00:00-05:00"><meta property="og:site_name" content="doretox"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://doretox.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="TryHackMe: Network Services 2 Walkthrough"><meta name=twitter:description content="Network Services 2 TryHackMe Room Walkthrough."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://doretox.github.io/posts/"},{"@type":"ListItem","position":2,"name":"TryHackMe: Network Services 2 Walkthrough","item":"https://doretox.github.io/posts/network-services-2-walkthrough/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TryHackMe: Network Services 2 Walkthrough","name":"TryHackMe: Network Services 2 Walkthrough","description":"Network Services 2 TryHackMe Room Walkthrough.","keywords":["TryHackMe"],"articleBody":"Task 2 Understanding NFS What does NFS stand for?\nNetwork File System\rWhat process allows an NFS client to interact with a remote directory as though it was a physical device?\nMounting\rWhat does NFS use to represent files and directories on the server?\nfile handle\rWhat protocol does NFS use to communicate between the server and client?\nRPC\rWhat two pieces of user data does the NFS server take as parameters for controlling user permissions? Format: parameter 1 / parameter 2\nuser ID / group ID\rCan a Windows NFS server share files with a Linux client? (Y/N)\nY\rCan a Linux NFS server share files with a MacOS client? (Y/N)\nY\rWhat is the latest version of NFS? [released in 2016, but is still up to date as of 2020] This will require external research.\n4.2\rTask 3 Enumerating NFS Conduct a thorough port scan scan of your choosing, how many ports are open?\n7\rWhich port contains the service we’re looking to enumerate?\n2049\rNow, use /usr/sbin/showmount -e [IP] to list the NFS shares, what is the name of the visible share?\n/home\rTime to mount the share to our local machine!\nFirst, use “mkdir /tmp/mount” to create a directory on your machine to mount the share to. This is in the /tmp directory- so be aware that it will be removed on restart.\nThen, use the mount command we broke down earlier to mount the NFS share to your local machine. Change directory to where you mounted the share- what is the name of the folder inside?\ncappucino\rHave a look inside this directory, look at the files. Looks like we’re inside a user’s home directory…\n(no answer needed)\rInteresting! Let’s do a bit of research now, have a look through the folders. Which of these folders could contain keys that would give us remote access to the server?\n.ssh\rWhich of these keys is most useful to us?\nid_rsa Copy this file to a different location your local machine, and change the permissions to “600” using “chmod 600 [file]”.\nAssuming we were right about what type of directory this is, we can pretty easily work out the name of the user this key corresponds to.\nCan we log into the machine using ssh -i @ ? (Y/N)\nY\rTask 4 Exploiting NFS First, change directory to the mount point on your machine, where the NFS share should still be mounted, and then into the user’s home directory.\n(no answer needed)\rDownload the bash executable to your Downloads directory. Then use “cp ~/Downloads/bash .” to copy the bash executable to the NFS share. The copied bash shell must be owned by a root user, you can set this using “sudo chown root bash”\n(no answer needed)\rNow, we’re going to add the SUID bit permission to the bash executable we just copied to the share using “sudo chmod +[permission] bash”. What letter do we use to set the SUID bit set using chmod?\ns\rLet’s do a sanity check, let’s check the permissions of the “bash” executable using “ls -la bash”. What does the permission set look like? Make sure that it ends with -sr-x.\n![[Pasted image 20230725093228.png]]\n-rwsr-sr-x\rNow, SSH into the machine as the user. List the directory to make sure the bash executable is there. Now, the moment of truth. Lets run it with “./bash -p”. The -p persists the permissions, so that it can run as root with SUID- as otherwise bash will sometimes drop the permissions.\n(no answer needed)\rGreat! If all’s gone well you should have a shell as root! What’s the root flag?\nTHM{nfs_got_pwned}\rTask 5 Understanding SMTP What does SMTP stand for?\nSimple Mail Transfer Protocol\rWhat does SMTP handle the sending of? (answer in plural)\nemails\rWhat is the first step in the SMTP process?\nSMTP Handshake\rWhat is the default SMTP port?\n25\rWhere does the SMTP server send the email if the recipient’s server is not available?\nSMTP queue\rOn what server does the Email ultimately end up on?\nPOP/IMAP\rCan a Linux machine run an SMTP server? (Y/N)\nY\rCan a Windows machine run an SMTP server? (Y/N)\nY\rTask 6 Enumerating SMTP First, lets run a port scan against the target machine, same as last time. What port is SMTP running on?\nFor this one run `nmap -A -p- `\r25\rOkay, now we know what port we should be targeting, let’s start up Metasploit. What command do we use to do this?\nmsfconsole\rLet’s search for the module “smtp_version”, what’s it’s full module name?\nauxiliary/scanner/smtp/smtp_version\rGreat, now- select the module and list the options. How do we do this?\noptions\rHave a look through the options, does everything seem correct? What is the option we need to set?\nRHOSTS\rSet that to the correct value for your target machine. Then run the exploit. What’s the system mail name?\npolosmtp.home\rWhat Mail Transfer Agent (MTA) is running the SMTP server? This will require some external research.\nFor this one I searched about it on google and find this link: https://www.offsec.com/metasploit-unleashed/scanner-smtp-auxiliary-modules/\nJust rum `smtp_enum` and you'll find the answer.\rPostfix\rGood! We’ve now got a good amount of information on the target system to move onto the next stage. Let’s search for the module “smtp_enum”, what’s it’s full module name?\nauxiliary/scanner/smtp/smtp_enum\rWe’re going to be using the “top-usernames-shortlist.txt” wordlist from the Usernames subsection of seclists (/usr/share/wordlists/SecLists/Usernames if you have it installed).\nWhat option do we need to set to the wordlist’s path?\nUSER_FILE\rOnce we’ve set this option, what is the other essential paramater we need to set?\nRHOSTS\rNow, run the exploit, this may take a few minutes, so grab a cup of tea, coffee, water. Keep yourself hydrated!\n(no answer needed)\rOkay! Now that’s finished, what username is returned?\nAdministrator\rTask 7 Exploiting SMTP What is the password of the user we found during our enumeration stage?\nrun **\"hydra -t 16 -l administrator -P /usr/share/wordlists/rockyou.txt -vV 10.10.128.200 ssh\"**\nalejandro\rGreat! Now, let’s SSH into the server as the user, what is contents of smtp.txt\nTHM{who_knew_email_servers_were_c00l}\rTask 8 Understanding MySQL What type of software is MySQL?\nrelational database management system\rWhat language is MySQL based on?\nSQL\rWhat communication model does MySQL use?\nclient-server\rWhat is a common application of MySQL?\nback end database\rWhat major social network uses MySQL as their back-end database? This will require further research.\nfacebook\rTask 9 As always, let’s start out with a port scan, so we know what port the service we’re trying to attack is running on. What port is MySQL using?\nfor this one I ran nmap -F -sV Good, now- we think we have a set of credentials. Let’s double check that by manually connecting to the MySQL server. We can do this using the command “mysql -h [IP] -u [username] -p”\nFirst you have to enumerate de mysql server. Run nmap -p 3306 --script=mysql-enum now run mysql -h 10.10.5.193 -u root -p with ‘password’ as password.\nOkay, we know that our login credentials work. Lets quit out of this session with “exit” and launch up Metasploit.\n(no answer needed)\nWe’re going to be using the “mysql_sql” module.\nSearch for, select and list the options it needs. What three options do we need to set? (in descending order).\npassword/rhosts/username\rRun the exploit. By default it will test with the “select version()” command, what result does this give you?\n5.7.29-0ubuntu0.18.04.1\rGreat! We know that our exploit is landing as planned. Let’s try to gain some more ambitious information. Change the “sql” option to “show databases”. how many databases are returned?\n4\rTask 10 Exploiting MySQL First, let’s search for and select the “mysql_schemadump” module. What’s the module’s full name?\nauxiliary/scanner/mysql/mysql_schemadump\rGreat! Now, you’ve done this a few times by now so I’ll let you take it from here. Set the relevant options, run the exploit. What’s the name of the last table that gets dumped?\nx$waits_global_by_latency\rAwesome, you have now dumped the tables, and column names of the whole database. But we can do one better… search for and select the “mysql_hashdump” module. What’s the module’s full name?\nauxiliary/scanner/mysql/mysql_hashdump\rAgain, I’ll let you take it from here. Set the relevant options, run the exploit. What non-default user stands out to you?\ncarl\rAnother user! And we have their password hash. This could be very interesting. Copy the hash string in full, like: bob:*HASH to a text file on your local machine called “hash.txt”.\nWhat is the user/hash combination string?\ncarl:*EA031893AA21444B170FC2162A56978B8CEECE18\rNow, we need to crack the password! Let’s try John the Ripper against it using: “john hash.txt” what is the password of the user we found?\ndoggie\rAwesome. Password reuse is not only extremely dangerous, but extremely common. What are the chances that this user has reused their password for a different service?\nWhat’s the contents of MySQL.txt\nSSH using ‘carl’ and ‘doggie’\nTHM{congratulations_you_got_the_mySQL_flag} ","wordCount":"1483","inLanguage":"en","datePublished":"2023-07-26T00:00:00-05:00","dateModified":"2023-07-26T00:00:00-05:00","author":{"@type":"Person","name":"doreox"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://doretox.github.io/posts/network-services-2-walkthrough/"},"publisher":{"@type":"Organization","name":"doretox","logo":{"@type":"ImageObject","url":"https://doretox.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://doretox.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://doretox.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://doretox.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://doretox.github.io/about/ title=About><span>About</span></a></li><li><a href=https://doretox.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://doretox.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://doretox.github.io/posts/>Posts</a></div><h1 class=post-title>TryHackMe: Network Services 2 Walkthrough</h1><div class=post-description>Network Services 2 TryHackMe Room Walkthrough.</div><div class=post-meta>&lt;span title='2023-07-26 00:00:00 -0500 -0500'>July 26, 2023&lt;/span>&amp;nbsp;·&amp;nbsp;doreox&nbsp;|&nbsp;<a href=https://github.com/doretox/doretox.github.io/content/posts/network-services-2-walkthrough.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h3 id=task-2-understanding-nfs>Task 2 Understanding NFS<a hidden class=anchor aria-hidden=true href=#task-2-understanding-nfs>#</a></h3><p>What does NFS stand for?</p><pre><code>Network File System
</code></pre><p>What process allows an NFS client to interact with a remote directory as though it was a physical device?</p><pre><code>Mounting
</code></pre><p>What does NFS use to represent files and directories on the server?</p><pre><code>file handle
</code></pre><p>What protocol does NFS use to communicate between the server and client?</p><pre><code>RPC
</code></pre><p>What two pieces of user data does the NFS server take as parameters for controlling user permissions? Format: parameter 1 / parameter 2</p><pre><code>user ID / group ID
</code></pre><p>Can a Windows NFS server share files with a Linux client? (Y/N)</p><pre><code>Y
</code></pre><p>Can a Linux NFS server share files with a MacOS client? (Y/N)</p><pre><code>Y
</code></pre><p>What is the latest version of NFS? [released in 2016, but is still up to date as of 2020] This will require external research.</p><pre><code>4.2
</code></pre><h3 id=task-3enumerating-nfs>Task 3 Enumerating NFS<a hidden class=anchor aria-hidden=true href=#task-3enumerating-nfs>#</a></h3><p>Conduct a thorough port scan scan of your choosing, how many ports are open?</p><pre><code>7
</code></pre><p>Which port contains the service we&rsquo;re looking to enumerate?</p><pre><code>2049
</code></pre><p>Now, use /usr/sbin/showmount -e [IP] to list the NFS shares, what is the name of the visible share?</p><pre><code>/home
</code></pre><p>Time to mount the share to our local machine!</p><p>First, use &ldquo;<em>mkdir /tmp/mount</em>&rdquo; to create a directory on your machine to mount the share to. This is in the /tmp directory- so be aware that it will be removed on restart.</p><p>Then, use the mount command we broke down earlier to mount the NFS share to your local machine. Change directory to where you mounted the share- what is the name of the folder inside?</p><pre><code>cappucino
</code></pre><p>Have a look inside this directory, look at the files. Looks like  we&rsquo;re inside a user&rsquo;s home directory&mldr;</p><pre><code>(no answer needed)
</code></pre><p>Interesting! Let&rsquo;s do a bit of research now, have a look through the folders. Which of these folde<strong>rs</strong>
could cont<strong>a</strong>in keys that would give us remote access to the server?</p><pre><code>.ssh
</code></pre><p>Which of these keys is most useful to us?</p><pre><code>id_rsa 
</code></pre><p>Copy this file to a different location your local machine, and change the permissions to &ldquo;600&rdquo; using &ldquo;chmod 600 [file]&rdquo;.</p><p>Assuming we were right about what type of directory this is, we can pretty easily work out the name of the user this key corresponds to.</p><p>Can we log into the machine using <em>ssh -i &lt;key-file> &lt;username>@&lt;ip></em> ? (Y/N)</p><pre><code>Y
</code></pre><h3 id=task-4-exploiting-nfs>Task 4 Exploiting NFS<a hidden class=anchor aria-hidden=true href=#task-4-exploiting-nfs>#</a></h3><p>First, change directory to the mount point on your machine, where the NFS share should still be mounted, and then into the user&rsquo;s home directory.</p><pre><code> (no answer needed)
</code></pre><p>Download the bash executable to your Downloads directory. Then use &ldquo;cp ~/Downloads/bash .&rdquo; to copy the bash executable to the NFS share. The copied bash shell must be owned by a root user, you can set this using &ldquo;sudo chown root bash&rdquo;</p><pre><code> (no answer needed)
</code></pre><p>Now, we&rsquo;re going to add the SUID bit permission to the bash executable we just copied to the share using &ldquo;sudo chmod +[permission] bash&rdquo;. What letter do we use to set the SUID bit set using chmod?</p><pre><code> s
</code></pre><p>Let&rsquo;s do a sanity check, let&rsquo;s check the permissions of the &ldquo;bash&rdquo; executable using &ldquo;ls -la bash&rdquo;. What does the permission set look like? Make sure that it ends with -sr-x.<br>![[Pasted image 20230725093228.png]]</p><pre><code> -rwsr-sr-x
</code></pre><p>Now, SSH into the machine as the user. List the directory to make sure the bash executable is there. Now, the moment of truth. Lets run it with &ldquo;<em>./bash -p</em>&rdquo;. The -p persists the permissions, so that it can run as root with SUID- as otherwise bash will sometimes drop the permissions.</p><pre><code> (no answer needed)
</code></pre><p>Great! If all&rsquo;s gone well you should have a shell as root! What&rsquo;s the root flag?</p><p><img loading=lazy src=/images/network-services-2/task4-flag.png alt="Task 4 Flag"></p><pre><code>THM{nfs_got_pwned}
</code></pre><h3 id=task-5-understanding-smtp>Task 5 Understanding SMTP<a hidden class=anchor aria-hidden=true href=#task-5-understanding-smtp>#</a></h3><p>What does SMTP stand for?</p><pre><code>Simple Mail Transfer Protocol
</code></pre><p>What does SMTP handle the sending of? (answer in plural)</p><pre><code>emails
</code></pre><p>What is the first step in the SMTP process?</p><pre><code>SMTP Handshake
</code></pre><p>What is the default SMTP port?</p><pre><code>25
</code></pre><p>Where does the SMTP server send the email if the recipient&rsquo;s server is not available?</p><pre><code>SMTP queue
</code></pre><p>On what server does the Email ultimately end up on?</p><pre><code>POP/IMAP
</code></pre><p>Can a Linux machine run an SMTP server? (Y/N)</p><pre><code>Y
</code></pre><p>Can a Windows machine run an SMTP server? (Y/N)</p><pre><code>Y
</code></pre><h3 id=task-6-enumerating-smtp>Task 6 Enumerating SMTP<a hidden class=anchor aria-hidden=true href=#task-6-enumerating-smtp>#</a></h3><p>First, lets run a port scan against the target machine, same as last time. What port is SMTP running on?</p><pre><code>For this one run `nmap -A -p- &lt;machine-ip&gt;`
</code></pre><p><img loading=lazy src=/images/network-services-2/task6-nmap.png alt="Task 6 nmap"></p><pre><code>25
</code></pre><p>Okay, now we know what port we should be targeting, let&rsquo;s start up Metasploit. What command do we use to do this?</p><pre><code>msfconsole
</code></pre><p>Let&rsquo;s search for the module &ldquo;smtp_version&rdquo;, what&rsquo;s it&rsquo;s full module name?</p><pre><code>auxiliary/scanner/smtp/smtp_version
</code></pre><p>Great, now- select the module and list the options. How do we do this?</p><pre><code>options
</code></pre><p>Have a look through the options, does everything seem correct? What is the option we need to set?</p><pre><code>RHOSTS
</code></pre><p>Set that to the correct value for your target machine. Then run the exploit. What&rsquo;s the system mail name?</p><pre><code>polosmtp.home
</code></pre><p>What Mail Transfer Agent (MTA) is running the SMTP server? This will require some external research.</p><p>For this one I searched about it on google and find this link: <a href=https://www.offsec.com/metasploit-unleashed/scanner-smtp-auxiliary-modules/>https://www.offsec.com/metasploit-unleashed/scanner-smtp-auxiliary-modules/</a></p><pre><code>Just rum `smtp_enum` and you'll find the answer.
</code></pre><p><img loading=lazy src=/images/network-services-2/task6-smtp-enum.png alt=SMTP_enum></p><pre><code>Postfix
</code></pre><p>Good! We&rsquo;ve now got a good amount of information on the target system to move onto the next stage. Let&rsquo;s search for the module &ldquo;<em>smtp_enum</em>&rdquo;, what&rsquo;s it&rsquo;s full module name?</p><pre><code>auxiliary/scanner/smtp/smtp_enum
</code></pre><p>We&rsquo;re going to be using the <em>&ldquo;top-usernames-shortlist.txt&rdquo;</em> wordlist from the Usernames subsection of seclists (/usr/share/wordlists/SecLists/Usernames if you have it installed).</p><p>What option do we need to set to the wordlist&rsquo;s path?</p><pre><code>USER_FILE
</code></pre><p>Once we&rsquo;ve set this option, what is the other essential paramater we need to set?</p><pre><code>RHOSTS
</code></pre><p>Now, run the exploit, this may take a few minutes, so grab a cup of tea, coffee, water. Keep yourself hydrated!</p><pre><code>(no answer needed)
</code></pre><p>Okay! Now that&rsquo;s finished, what username is returned?</p><p><img loading=lazy src=/images/network-services-2/task6-username.png alt=Username></p><pre><code>Administrator
</code></pre><h3 id=task-7-exploiting-smtp>Task 7  Exploiting SMTP<a hidden class=anchor aria-hidden=true href=#task-7-exploiting-smtp>#</a></h3><p>What is the password of the user we found during our enumeration stage?</p><p>run <code>**"hydra -t 16 -l administrator -P /usr/share/wordlists/rockyou.txt -vV 10.10.128.200 ssh"**</code></p><p><img loading=lazy src=/images/network-services-2/task7-hydra.png alt=Hydra></p><pre><code>alejandro
</code></pre><p>Great! Now, let&rsquo;s SSH into the server as the user, what is contents of smtp.txt</p><pre><code>THM{who_knew_email_servers_were_c00l}
</code></pre><h3 id=task-8-understanding-mysql>Task 8 Understanding MySQL<a hidden class=anchor aria-hidden=true href=#task-8-understanding-mysql>#</a></h3><p>What type of software is MySQL?</p><pre><code>relational database management system
</code></pre><p>What language is MySQL based on?</p><pre><code>SQL
</code></pre><p>What communication model does MySQL use?</p><pre><code>client-server
</code></pre><p>What is a common application of MySQL?</p><pre><code>back end database
</code></pre><p>What major social network uses MySQL as their back-end database? This will require further research.</p><pre><code>facebook
</code></pre><h3 id=task-9>Task 9<a hidden class=anchor aria-hidden=true href=#task-9>#</a></h3><p>As always, let&rsquo;s start out with a port scan, so we know what port the service we&rsquo;re trying to attack is running on. What port is MySQL using?</p><p>for this one I ran <code>nmap -F -sV &lt;ip></code></p><p><img loading=lazy src=/images/network-services-2/task9-nmap.png alt="Task 9 nmap"></p><p>Good, now- we think we have a set of credentials. Let&rsquo;s double check that by manually connecting to the MySQL server. We can do this using the command &ldquo;<em>mysql -h [IP] -u [username] -p</em>&rdquo;</p><p> First you have to enumerate de mysql server. Run <code>nmap -p 3306 --script=mysql-enum &lt;ip></code>
 
<img loading=lazy src=/images/network-services-2/task9-mysql-enum.png alt="Task 9 mysql-enum"></p><p>now run <code>mysql -h 10.10.5.193 -u root -p</code> with &lsquo;password&rsquo; as password.</p><p>Okay, we know that our login credentials work. Lets quit out of this session with &ldquo;exit&rdquo; and launch up Metasploit.</p><p><img loading=lazy src=/images/network-services-2/mysql-connect.png alt="MySQL Connect"></p><p>  (no answer needed)</p><p>We&rsquo;re going to be using the &ldquo;mysql_sql&rdquo; module.</p><p>Search for, select and list the options it needs. What three options do we need to set? (in descending order).<br> 
<img loading=lazy src=/images/network-services-2/mysql_sql-options.png alt="MySQL_sql options"></p><pre><code>password/rhosts/username
</code></pre><p>Run the exploit. By default it will test with the &ldquo;select version()&rdquo; command, what result does this give you?</p><p><img loading=lazy src=/images/network-services-2/mysql_sql-run.png alt="MySQL_sql run"></p><pre><code>5.7.29-0ubuntu0.18.04.1
</code></pre><p>Great! We know that our exploit is landing as planned. Let&rsquo;s try to gain some more ambitious information. Change the &ldquo;sql&rdquo; option to &ldquo;show databases&rdquo;. how many databases are returned?</p><p><img loading=lazy src=/images/network-services-2/mysql_sql-showdatabases.png alt="MySQL Show Databases"></p><pre><code>4
</code></pre><h3 id=task-10-exploiting-mysql>Task 10 Exploiting MySQL<a hidden class=anchor aria-hidden=true href=#task-10-exploiting-mysql>#</a></h3><p>First, let&rsquo;s search for and select the &ldquo;mysql_schemadump&rdquo; module. What&rsquo;s the module&rsquo;s full name?</p><p><img loading=lazy src=/images/network-services-2/task10-schemadump.png alt="MySQL Schemadump"></p><pre><code>auxiliary/scanner/mysql/mysql_schemadump
</code></pre><p>Great! Now, you&rsquo;ve done this a few times by now so I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What&rsquo;s the name of the last table that gets dumped?</p><pre><code>x$waits_global_by_latency
</code></pre><p>Awesome, you have now dumped the tables, and column names of the whole database. But we can do one better&mldr; search for and select the &ldquo;mysql_hashdump&rdquo; module. What&rsquo;s the module&rsquo;s full name?</p><pre><code>auxiliary/scanner/mysql/mysql_hashdump
</code></pre><p>Again, I&rsquo;ll let you take it from here. Set the relevant options, run the exploit. What non-default user stands out to you?</p><p><img loading=lazy src=/images/network-services-2/task10-hashdump.png alt="MySQL Hashdump"></p><pre><code>carl
</code></pre><p>Another user! And we have their password hash. This could be very interesting. Copy the hash string in full, like: bob:*HASH to a text file on your local machine called &ldquo;hash.txt&rdquo;.</p><p>What is the user/hash combination string?</p><pre><code>carl:*EA031893AA21444B170FC2162A56978B8CEECE18
</code></pre><p>Now, we need to crack the password! Let&rsquo;s try John the Ripper against it using: &ldquo;<em>john hash.txt</em>&rdquo; what is the password of the user we found?</p><p><img loading=lazy src=/images/network-services-2/task10-password.png alt="Task 10 Password"></p><pre><code>doggie
</code></pre><p>Awesome. Password reuse is not only extremely dangerous, but extremely common. What are the chances that this user has reused their password for a different service?</p><p>What&rsquo;s the contents of MySQL.txt</p><p>SSH using &lsquo;carl&rsquo; and &lsquo;doggie&rsquo;</p><p><img loading=lazy src=/images/network-services-2/task10-flag.png alt="Task 10 flag"></p><pre><code>THM{congratulations_you_got_the_mySQL_flag}</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://doretox.github.io/tags/tryhackme/>TryHackMe</a></li></ul><nav class=paginav><a class=prev href=https://doretox.github.io/posts/fundamentos-devsecops/><span class=title>« Prev</span><br><span>Princípios Fundamentais de DevSecOps</span>
</a><a class=next href=https://doretox.github.io/posts/activation-function/><span class=title>Next »</span><br><span>Activation Functions in AI</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://doretox.github.io/>doretox</a></span>
<span></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>